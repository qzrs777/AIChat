name: Pull Request Check Build

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout AIChat
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.sha }}

      - name: Cache APT packages
        uses: awalsh128/cache-apt-pkgs-action@v1
        with:
          packages: mono-complete zip pandoc

      - name: Download Unity assemblies from NuGet
        run: build-resource/buildenv/download-unityengine.sh
      - name: Download BepInEx
        run: build-resource/buildenv/download-bepinex.sh

      - name: Add README.html
        run: build-resource/buildenv/build-README.sh

      - name: Upload PR Build Artifact
        uses: actions/upload-artifact@v4
        with:
          name: AIChatMod-PR-${{ github.event.pull_request.number }}
          path: build-resource/assets/
          retention-days: 5
